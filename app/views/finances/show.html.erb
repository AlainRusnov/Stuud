<!-- STUUD Finances -->
<div class="finances">
  <div class="container-left">
    <h1>My Finances</h1>
    <hr/>

    <div class="graph-buttons">
      <div>
        <a href="?my_finances=week" class="btn-graph">Week</a>
      </div>
      <div>
        <a href="?my_finances=month" class="btn-graph">Month</a>
      </div>
      <div>
        <a href="?my_finances=year" class="btn-graph">Year</a>
      </div>
    </div>

    <div class="graph">

    <%= column_chart [{ name: "Income", data: @events_yearly.group_by_week(:start_time).sum(:price) },{ name: "Expenses", data: Expense.group_by_week(:date).sum(:amount)}],
        suffix: "$",
        width: "600px",
        height: "400px",
        title: "Expected Income #{@income_yearly} $ vs. Total Expenses #{@total_expenses_yearly} $  (#{DateTime.now.year}) ",
        legend: true,
        colors: ["#FB6C00", "#424D58"] %>

    </div>
    <div class="data-graph">
      <div class="card-data income">
        <h3>Income</h3>
        <% if @income == nil %>
          <p>$0</p>
        <% else %>
          <p>$<%= @income %></p>
        <% end %>
      </div>
      <div class="bold mt-2"><p>-</p></div>
      <div class="card-data expenses">
        <h3>Expenses</h3>
        <p>$<%= @total_expenses %></p>
      </div>
      <div class="bold mt-2"><p>=</p></div>
      <div class="card-data total">
        <h3>Profit</h3>
        <% if @profit == nil %>
          <p>$0</p>
        <% else %>
          <p><%= @profit %></p>
        <% end %>
      </div>
    </div>
  </div>
  <div class="container-right">
  <h1>Invoices</h1>

  <div class="invoice-buttons">
    <div>
      <a href="?invoices=overdue" class="link">Overdue</a>
    </div>
    <div>
      <a href="?invoices=pending" class="link">Pending</a>
    </div>
    <div>
      <a href="?invoices=paid" class="link">Paid</a>
    </div>
  </div>

    <hr/>
    <div class="invoices">
  <!------------------ OVERDUE INVOICES ------------------>
  <div class="overdue">
    <div class="divider">
      <h2 class="divider">Overdue</h2>
    </div>
    <% @overdue_invoices.each do |invoice| %>
      <div class="card-invoice">
        <div class="client-name">
          <% if invoice.client.last_name.length > 10 %>
            <%= link_to invoice.client.first_name + " " + invoice.client.last_name[0] + ".", client_path(invoice.client), class: "client-name" %>
          <% else %>
            <%= link_to invoice.client.first_name + " " + invoice.client.last_name, client_path(invoice.client), class: "client-name" %>
          <% end %>
        </div>
        <div id="invoice-info">
          <p>Invoice #<%= invoice.id %></p>
          <p>$<%= invoice.price %></p>
          <p class="bold">OVERDUE </p>
<!--           <%= invoice.start_time.localtime.strftime("%b %d") %> -->
        </div>
        <div class="invoice-status-indicator" data-toggle="modal" data-target="#invoice-id-<%=invoice.id%>">
          <%= image_tag "noun_Close_23269(1).png", alt: "overdue icon"%>
        </div>
      </div>
      <!-- Invoice Status Modal -->
      <div class="modal fade" id="invoice-id-<%=invoice.id%>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <%=simple_form_for invoice do |f|%>
              <%= f.input :status, as: :hidden, input_html: {value: true} %>
              <%= f.submit %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <!------------------ PENDING INVOICES ------------------>

  <div class="pending">
    <div class="divider">
      <h2 class="divider">Pending</h2>
    </div>
    <% @pending_invoices.each do |invoice| %>
      <div class="card-invoice">
        <div class="client-name">
          <% if invoice.client.last_name.length > 10 %>
            <%= link_to invoice.client.first_name + " " + invoice.client.last_name[0] + ".", client_path(invoice.client), class: "client-name" %>
          <% else %>
            <%= link_to invoice.client.first_name + " " + invoice.client.last_name, client_path(invoice.client), class: "client-name" %>
          <% end %>
        </div>
        <div id="invoice-info">
          <p>Invoice #<%= invoice.id %></p>
          <p>$<%= invoice.price %></p>
          <p class="bold"><%= invoice.start_time.localtime.strftime("%b %d") %></p>
        </div>
        <div class="invoice-status-indicator">
          <%= image_tag "noun_clock_23236.png", alt: "pending icon"%>
        </div>
      </div>
    <% end %>
  </div>

  <!------------------ PAID INVOICES ------------------>

  <div class="paid">
    <div class="divider">
      <h2 class="divider">Paid</h2>
    </div>
    <% @paid_invoices.each do |invoice| %>
      <div class="card-invoice">
        <div class="client-name">
          <% if invoice.client.last_name.length > 10 %>
            <%= link_to invoice.client.first_name + " " + invoice.client.last_name[0] + ".", client_path(invoice.client), class: "client-name" %>
          <% else %>
            <%= link_to invoice.client.first_name + " " + invoice.client.last_name, client_path(invoice.client), class: "client-name" %>
          <% end %>
        </div>
        <div id="invoice-info">
          <p>Invoice #<%= invoice.id %></p>
          <p>$<%= invoice.price %></p>
          <p class="bold">PAID </p>
<!--           <%= invoice.start_time.localtime.strftime("%A, %b %d") %> -->
        </div>
        <div class="invoice-status-indicator">
          <%= image_tag "noun_Check Mark_23235.png", alt: "paid icon"%>
        </div>
      </div>
    <% end %>
  </div>
</div>
